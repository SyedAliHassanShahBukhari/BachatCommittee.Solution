openapi: 3.0.3
info:
  title: Web Pool Super Admin API
  version: "1.0"
servers:
  - url: https://api.example.com
security:
  - bearerAuth: []
tags:
  - name: Tenants
  - name: Users
  - name: Roles
  - name: Configurations
  - name: Rules
  - name: Audit
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    GenericReponseDto:
      type: object
      properties:
        statusCode:
          type: integer
        message:
          type: string
        response:
          nullable: true
    ValidationErrorResponse:
      allOf:
        - $ref: '#/components/schemas/GenericReponseDto'
      properties:
        response:
          type: object
          properties:
            errors:
              type: object
              additionalProperties:
                type: string
    TenantCreateRequest:
      type: object
      required: [name, code, timezone, currency, isActive]
      properties:
        name: { type: string }
        code: { type: string }
        timezone: { type: string }
        currency: { type: string }
        isActive: { type: boolean }
    TenantStatusRequest:
      type: object
      required: [isActive]
      properties:
        isActive: { type: boolean }
        reason: { type: string }
    UserLockRequest:
      type: object
      required: [isLocked]
      properties:
        isLocked: { type: boolean }
        reason: { type: string }
    RoleCreateRequest:
      type: object
      required: [name, permissions]
      properties:
        name: { type: string }
        permissions:
          type: array
          items: { type: string }
    GlobalConfigModel:
      type: object
      additionalProperties: true
    RuleCreateRequest:
      type: object
      required: [name, scope, isEnabled, condition, action]
      properties:
        name: { type: string }
        description: { type: string }
        scope: { type: string, enum: [global, tenant] }
        tenantId: { type: string, nullable: true }
        isEnabled: { type: boolean }
        condition: { type: string }
        action: { type: string }
paths:
  /api/v1/super-admin/tenants:
    post:
      tags: [Tenants]
      summary: Create tenant
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/TenantCreateRequest' }
      responses:
        "201": { description: Created, content: { application/json: { schema: { $ref: '#/components/schemas/GenericReponseDto' } } } }
        "400": { description: Validation failed, content: { application/json: { schema: { $ref: '#/components/schemas/ValidationErrorResponse' } } } }
        "401": { description: Unauthorized }
        "403": { description: Forbidden }
        "409": { description: Conflict }
        "500": { description: Server error }
    get:
      tags: [Tenants]
      summary: List tenants (paged)
      parameters:
        - in: query
          name: page
          schema: { type: integer, default: 1 }
        - in: query
          name: pageSize
          schema: { type: integer, default: 50, maximum: 100 }
        - in: query
          name: search
          schema: { type: string }
        - in: query
          name: isActive
          schema: { type: boolean }
      responses:
        "200": { description: OK, content: { application/json: { schema: { $ref: '#/components/schemas/GenericReponseDto' } } } }
  /api/v1/super-admin/tenants/{tenantId}:
    get:
      tags: [Tenants]
      summary: Get tenant detail
      parameters:
        - in: path
          name: tenantId
          required: true
          schema: { type: string }
      responses:
        "200": { description: OK, content: { application/json: { schema: { $ref: '#/components/schemas/GenericReponseDto' } } } }
        "404": { description: Not found }
    put:
      tags: [Tenants]
      summary: Update tenant
      parameters:
        - in: path
          name: tenantId
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/TenantCreateRequest' }
      responses:
        "200": { description: OK, content: { application/json: { schema: { $ref: '#/components/schemas/GenericReponseDto' } } } }
        "400": { description: Validation failed }
        "404": { description: Not found }
    delete:
      tags: [Tenants]
      summary: Soft delete tenant (confirm required)
      parameters:
        - in: path
          name: tenantId
          required: true
          schema: { type: string }
        - in: query
          name: confirm
          required: true
          schema: { type: boolean }
      responses:
        "200": { description: OK, content: { application/json: { schema: { $ref: '#/components/schemas/GenericReponseDto' } } } }
        "400": { description: Missing confirm }
        "404": { description: Not found }
  /api/v1/super-admin/tenants/{tenantId}/status:
    patch:
      tags: [Tenants]
      summary: Activate/Suspend tenant
      parameters:
        - in: path
          name: tenantId
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/TenantStatusRequest' }
      responses:
        "200": { description: OK, content: { application/json: { schema: { $ref: '#/components/schemas/GenericReponseDto' } } } }
  /api/v1/super-admin/users:
    get:
      tags: [Users]
      summary: Global user search (paged)
      parameters:
        - in: query
          name: email
          schema: { type: string }
        - in: query
          name: role
          schema: { type: string }
        - in: query
          name: tenantId
          schema: { type: string }
        - in: query
          name: status
          schema: { type: string }
        - in: query
          name: page
          schema: { type: integer, default: 1 }
        - in: query
          name: pageSize
          schema: { type: integer, default: 50, maximum: 100 }
      responses:
        "200": { description: OK, content: { application/json: { schema: { $ref: '#/components/schemas/GenericReponseDto' } } } }
  /api/v1/super-admin/users/{userId}:
    get:
      tags: [Users]
      summary: Get user detail
      parameters:
        - in: path
          name: userId
          required: true
          schema: { type: string }
      responses:
        "200": { description: OK, content: { application/json: { schema: { $ref: '#/components/schemas/GenericReponseDto' } } } }
        "404": { description: Not found }
  /api/v1/super-admin/users/{userId}/logout:
    post:
      tags: [Users]
      summary: Force logout user
      parameters:
        - in: path
          name: userId
          required: true
          schema: { type: string }
      responses:
        "200": { description: OK, content: { application/json: { schema: { $ref: '#/components/schemas/GenericReponseDto' } } } }
  /api/v1/super-admin/users/{userId}/lock:
    patch:
      tags: [Users]
      summary: Lock/Unlock user
      parameters:
        - in: path
          name: userId
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/UserLockRequest' }
      responses:
        "200": { description: OK, content: { application/json: { schema: { $ref: '#/components/schemas/GenericReponseDto' } } } }
  /api/v1/super-admin/roles:
    post:
      tags: [Roles]
      summary: Create role
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/RoleCreateRequest' }
      responses:
        "201": { description: Created, content: { application/json: { schema: { $ref: '#/components/schemas/GenericReponseDto' } } } }
    get:
      tags: [Roles]
      summary: List roles (paged)
      parameters:
        - in: query
          name: page
          schema: { type: integer, default: 1 }
        - in: query
          name: pageSize
          schema: { type: integer, default: 50, maximum: 100 }
      responses:
        "200": { description: OK, content: { application/json: { schema: { $ref: '#/components/schemas/GenericReponseDto' } } } }
  /api/v1/super-admin/roles/{roleId}:
    put:
      tags: [Roles]
      summary: Update role permissions
      parameters:
        - in: path
          name: roleId
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/RoleCreateRequest' }
      responses:
        "200": { description: OK, content: { application/json: { schema: { $ref: '#/components/schemas/GenericReponseDto' } } } }
  /api/v1/super-admin/configurations/global:
    get:
      tags: [Configurations]
      summary: Get global configuration
      responses:
        "200": { description: OK, content: { application/json: { schema: { $ref: '#/components/schemas/GenericReponseDto' } } } }
    put:
      tags: [Configurations]
      summary: Update global configuration
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/GlobalConfigModel' }
      responses:
        "200": { description: OK, content: { application/json: { schema: { $ref: '#/components/schemas/GenericReponseDto' } } } }
  /api/v1/super-admin/configurations/tenants/{tenantId}:
    get:
      tags: [Configurations]
      summary: Get tenant configuration overrides
      parameters:
        - in: path
          name: tenantId
          required: true
          schema: { type: string }
      responses:
        "200": { description: OK, content: { application/json: { schema: { $ref: '#/components/schemas/GenericReponseDto' } } } }
    put:
      tags: [Configurations]
      summary: Update tenant configuration overrides
      parameters:
        - in: path
          name: tenantId
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/GlobalConfigModel' }
      responses:
        "200": { description: OK, content: { application/json: { schema: { $ref: '#/components/schemas/GenericReponseDto' } } } }
  /api/v1/super-admin/rules:
    post:
      tags: [Rules]
      summary: Create rule
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/RuleCreateRequest' }
      responses:
        "201": { description: Created, content: { application/json: { schema: { $ref: '#/components/schemas/GenericReponseDto' } } } }
    get:
      tags: [Rules]
      summary: List rules (paged)
      parameters:
        - in: query
          name: page
          schema: { type: integer, default: 1 }
        - in: query
          name: pageSize
          schema: { type: integer, default: 50, maximum: 100 }
        - in: query
          name: scope
          schema: { type: string }
        - in: query
          name: isEnabled
          schema: { type: boolean }
      responses:
        "200": { description: OK, content: { application/json: { schema: { $ref: '#/components/schemas/GenericReponseDto' } } } }
  /api/v1/super-admin/rules/{ruleId}/status:
    patch:
      tags: [Rules]
      summary: Enable/Disable rule
      parameters:
        - in: path
          name: ruleId
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [isEnabled]
              properties:
                isEnabled: { type: boolean }
      responses:
        "200": { description: OK, content: { application/json: { schema: { $ref: '#/components/schemas/GenericReponseDto' } } } }
  /api/v1/super-admin/rules/{ruleId}/execute:
    post:
      tags: [Rules]
      summary: Execute rule (dryRun supported)
      parameters:
        - in: path
          name: ruleId
          required: true
          schema: { type: string }
        - in: query
          name: dryRun
          schema: { type: boolean, default: true }
      responses:
        "200": { description: OK, content: { application/json: { schema: { $ref: '#/components/schemas/GenericReponseDto' } } } }
  /api/v1/super-admin/audit-logs:
    get:
      tags: [Audit]
      summary: Retrieve audit logs (paged)
      parameters:
        - in: query
          name: page
          schema: { type: integer, default: 1 }
        - in: query
          name: pageSize
          schema: { type: integer, default: 50, maximum: 100 }
        - in: query
          name: actorId
          schema: { type: string }
        - in: query
          name: entityType
          schema: { type: string }
        - in: query
          name: dateFrom
          schema: { type: string, format: date-time }
        - in: query
          name: dateTo
          schema: { type: string, format: date-time }
      responses:
        "200": { description: OK, content: { application/json: { schema: { $ref: '#/components/schemas/GenericReponseDto' } } } }
